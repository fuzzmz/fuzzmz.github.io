
<!DOCTYPE html>
<html lang="en">
<head>
    <script type="text/javascript">
        var host = "fuzz.me.uk";
        if ((host == window.location.host) && (window.location.protocol != "https:"))
            window.location.protocol = "https";
    </script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="author" content="fuzzmz" />
        <meta name="keywords" content="design,wtf" />
        <meta name="description" content="It is a known fact that some of the hardware we sell gets either a bit too hot, or a bit too loud, but I never until now thought that we’re throwing out money in the (cooler) wind…" />

<!-- Open Graph tags -->
<meta property="og:site_name" content="Fuzzmz | ramblings on tech, life, and randomness by Serban Constantin"/>
<meta property="twitter:site" content="@fuzzmz"/>
<meta property="twitter:creator" content="@fuzzmz"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Burn it all"/>
    <meta property="og:url" content="https://fuzz.me.uk/burn-it-all/"/>
    <meta property="og:description" content="It is a known fact that some of the hardware we sell gets either a bit too hot, or a bit too loud, but I never until now thought that we’re throwing out money in the (cooler) wind…"/>
    <meta property="article:published_time" content="2016-04-01" />
    <meta property="article:section" content="misc" />
        <meta property="article:tag" content="design" />
        <meta property="article:tag" content="wtf" />
        <meta property="article:author" content="fuzzmz" />
        <meta property="og:image"
              content="https://fuzz.me.uk/images/burn-it-all/server-on-fire.jpg"/>
        <meta property="twitter:card" content="summary_large_image">

    <title>Burn it all - Fuzzmz | ramblings on tech, life, and randomness by Serban Constantin</title>

        <link rel="stylesheet" href="https://fuzz.me.uk/theme/css/bootstrap.sandstone.min.css" type="text/css"/>

    <link href="https://fuzz.me.uk/theme/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://fuzz.me.uk/theme/css/pygments/colorful.css" rel="stylesheet" />
    
        <link href="https://fuzz.me.uk/theme/css/typogrify.css" rel="stylesheet" />
    <link href="https://fuzz.me.uk/theme/css/pelican-twitchy.min.css" rel="stylesheet" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Feeds -->
</head>
<body data-spy="scroll" data-target="#scrollspy">
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper-small" class="twitchy-background">
            <ul id="accordion-small" class="sidebar-nav sidebar-nav-small">
                <li>
        <a href="https://fuzz.me.uk" title="Fuzzmz | ramblings on tech, life, and randomness by Serban Constantin" class="collapsed">
            <span class="glyphicon glyphicon-home"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
        <a href="https://fuzz.me.uk/archives.html" title="Recent Articles" class="collapsed">
            <span class="glyphicon glyphicon-th-list"></span>
        </a>
    </li>
                
                <li class="nav-divider"></li>
                <li id="share-small">
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-share-small" title="Share" class="collapsed">
                        <i class="fa fa-share-alt padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-share-small" class="collapse ">
                    <li>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://fuzz.me.uk/burn-it-all/" title="Share via Facebook" target="popup">
                            <i class="fa fa-facebook-square padding-small"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://plus.google.com/share?url=https://fuzz.me.uk/burn-it-all/" title="Share via Google+" target="popup">
                            <i class="fa fa-google-plus padding-small"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/share" class="twitter-share-button" data-count="vertical" title="Share via Twitter" target="popup">
                            <i class="fa fa-twitter-square padding-small"></i>
                        </a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-social-small" title="Social" class="collapsed">
                        <i class="fa fa-users padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social-small" class="collapse ">
                    <li>
                        <a href="https://github.com/fuzzmz" title="GitHub"><i class="fa fa-github-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="https://plus.google.com/+serbanconstantin" title="Google+"><i class="fa fa-google-plus-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="https://feeds.feedburner.com/fuzzmeuk" title="RSS"><i class="fa fa-rss-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="https://twitter.com/fuzzmz" title="Twitter"><i class="fa fa-twitter-square fa-lg padding-small"></i></a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
        <a href="#" title="Back to top" class="collapsed">
            <span class="fa fa-arrow-up"></span>
        </a>
    </li>
            </ul>
        </div>
        <div id="sidebar-wrapper" class="twitchy-background">
            <ul id="accordion" class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="https://fuzz.me.uk/">
                            <span class="glyphicon glyphicon-home padding-small"></span>
                            Home
                    </a>
                </li>
                    <li class="nav-divider"></li>
                    <li>
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapse-latest">
                            <span class="glyphicon glyphicon-th-list padding-small"></span>
                            Recent Articles
                        </a>
                    </li>
                    <li class="panel anti-panel"><ul id="collapse-latest" class="sidebar_submenu collapse in">
                        <li class="active">
                            <a class="hide-overflow" href="https://fuzz.me.uk/burn-it-all/" title="Burn it all">
                                <i class="fa fa-file-text padding-small"></i>
                                Burn it all
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="https://fuzz.me.uk/https-now-green/" title="Green URL bar">
                                <i class="fa fa-file-text padding-small"></i>
                                Green URL bar
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="https://fuzz.me.uk/making-private-tests-public/" title="Making private tests public">
                                <i class="fa fa-file-text padding-small"></i>
                                Making private tests public
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="https://fuzz.me.uk/google-photos-shared-albums-annoyances/" title="Google Photos Shared Albums annoyances">
                                <i class="fa fa-file-text padding-small"></i>
                                Google Photos Shared Albums annoyances
                            </a>
                        </li>
                        <li class="">
                            <a class="hide-overflow" href="https://fuzz.me.uk/oh-kernel-my-kernel/" title="Oh kernel, my kernel">
                                <i class="fa fa-file-text padding-small"></i>
                                Oh kernel, my kernel
                            </a>
                        </li>
                    <li>
                        <a href="https://fuzz.me.uk/archives.html">
                            <i class="fa fa-arrow-right padding-small"></i>
                            More
                        </a>
                    </li>
                    </ul></li>
                <li class="nav-divider"></li>
                <li id="share">
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-share" title="Share" class="collapsed">
                        <i class="fa fa-share-alt padding-small"></i>
                        Share
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-share" class="sidebar_submenu collapse ">
                    <li>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://fuzz.me.uk/burn-it-all/" target="popup">
                            <i class="fa fa-facebook-square padding-small"></i>
                            Facebook
                        </a>
                    </li>
                    <li>
                        <a href="https://plus.google.com/share?url=https://fuzz.me.uk/burn-it-all/" target="popup">
                            <i class="fa fa-google-plus padding-small"></i>
                            Google+
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/share" class="twitter-share-button" data-count="vertical" target="popup">
                            <i class="fa fa-twitter-square padding-small"></i>
                            Twitter
                        </a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-social">
                        <i class="fa fa-users padding-small"></i>
                        Contact
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social" class="sidebar_submenu collapse ">
                    <li>
                        <a href="https://github.com/fuzzmz" title="GitHub">
                            <i class="fa fa-github-square fa-lg padding-small"></i>
                            GitHub
                        </a>
                    </li>
                    <li>
                        <a href="https://plus.google.com/+serbanconstantin" title="Google+">
                            <i class="fa fa-google-plus-square fa-lg padding-small"></i>
                            Google+
                        </a>
                    </li>
                    <li>
                        <a href="https://feeds.feedburner.com/fuzzmeuk" title="RSS">
                            <i class="fa fa-rss-square fa-lg padding-small"></i>
                            RSS
                        </a>
                    </li>
                    <li>
                        <a href="https://twitter.com/fuzzmz" title="Twitter">
                            <i class="fa fa-twitter-square fa-lg padding-small"></i>
                            Twitter
                        </a>
                    </li>
                </ul></li>
                
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-categories">
                        <i class="fa fa-folder-open padding-small"></i>
                        Categories
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-categories" class="sidebar_submenu collapse ">
                    <li >
                        <a href="https://fuzz.me.uk/category/debug.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            debug
                            <span class="badge pull-right categorybadge">14</span>
                        </a>
                    </li>
                    <li >
                        <a href="https://fuzz.me.uk/category/how-to.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            how-to
                            <span class="badge pull-right categorybadge">7</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="https://fuzz.me.uk/category/misc.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            misc
                            <span class="badge pull-right categorybadge">31</span>
                        </a>
                    </li>
                    <li >
                        <a href="https://fuzz.me.uk/category/ux.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            ux
                            <span class="badge pull-right categorybadge">4</span>
                        </a>
                    </li>
                </ul></li>
                
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- open/close sidebar -->
        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <span id="right-arrow" class="glyphicon glyphicon-chevron-right"  title="expand sidebar"></span>
            <span id="left-arrow" class="glyphicon glyphicon-chevron-left" title="minimize sidebar"></span>
        </a>
       <!-- /open/close sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
<section id="content">
    <article>
        <div class="row">
            <div class="col-lg-9">
                <header class="page-header">
                    <h1>
                        <a href="https://fuzz.me.uk/burn-it-all/"
                           rel="bookmark"
                           title="Permalink to Burn it all">
                            Burn it&nbsp;all
                        </a>
                        <small>
<div class="post-info">
    <div class="publish-info-block">
        <small>
            <span class="published">
                <i class="fa fa-calendar padding-small"></i><time datetime="2016-04-01T00:00:00+03:00"> 2016-04-01</time>
            </span>
            <span class="category">
                <i class="fa fa-folder-open padding-small"></i><a href="https://fuzz.me.uk/category/misc.html">misc</a>
            </span>
            <span class="tags">
                <i class="fa fa-tags padding-small"></i>
                <a href="https://fuzz.me.uk/tag/design.html">design</a> /                 <a href="https://fuzz.me.uk/tag/wtf.html">wtf</a>            </span>
        </small>
    </div>
</div><!-- /.post-info -->                        </small>
                    </h1>
                </header>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-9">
                <div class="entry-content">
                    <p>It is a known fact that some of the hardware we sell gets either a bit too hot, or a bit too loud, but I never until now thought that we&rsquo;re throwing out money in the (cooler) wind&hellip; at least until we received the following email from one of our field engineers, the people who are in direct contact with our customers and help diagnose their&nbsp;issues.</p>
<p>What follows is a sanitized email from one of them, published with consent and&nbsp;sanitized.</p>
<hr/>
<blockquote>
<p>All,</p>
<p>I&rsquo;d like to share a small story that currently ends with one experimental, somewhat incomplete,
uncalibrated, but possibly helpful line of cryptic U-Boot environment to keep the suspense&nbsp;going:</p>
<blockquote>
<p><code>silentfan=i2c mw 2f 0.1 80; i2c mw 2f 58.1 1; i2c mw 2f 0.1 82; i2c mw 2f 10.1 34; i2c mw 2f 11.1
34; i2c mw 2f 7.1 3f; i2c mw 2f 1.1 f; i2c mw 2f 2.1 f; i2c mw 2f 5.1 f; i2c mw 2f 6.1 f; i2c mw 2f 0.1 80</code></p>
</blockquote>
<p>The story starts with an <span class="caps">BOARD1</span>, involves early and late <span class="caps">BOARD2</span>, and goes back to
a <span class="caps">BOARD3</span>.</p>
<p>Once upon a time an engineer received a <span class="caps">BOARD1</span> and got some very explicit comments in the cubicle office
environment for turning it on because of the noise it made. So he came up with a simple cardboard
shield for the flat front fan to ensure that all the air actually went through the SoC heatsink properly.
That way, he could disconnect two of the three fans in the back and add a resistor cable to the front fan
to slow it down. The <span class="caps">BOARD1</span> was ok&nbsp;then.</p>
<p>Time passes and along comes the first <span class="caps">BOARD2</span> which looked like the early <span class="caps">BOARD1</span> inside the box. After
turning it on for the very first time, it got turned off <span class="caps">VERY</span> quickly because it was much worse. The same
cardboard shield and modification was added. It was bearable then.
When another engineer visited the office with an unmodified <span class="caps">BOARD2</span> and used it in open space, he got
nearly threatened with violence.
Then new BOARD2s with a black airflow shield over the heatsink happened, which was a really great idea.
The fans used were not, so that one also got modified by replacing the back fans with quiet ones and
disconnecting the useless front fan completely. Again it was ok&nbsp;then.</p>
<p>Along the way the engineer discovered that a <span class="caps">BOM</span> mistake had been made for the <span class="caps">BOARD2</span> that caused <span class="caps">I2C</span>
to be effectively partially non-functional without software patches to the <span class="caps">SDK</span>. Two resistors were
missing. Adding software patches to the <span class="caps">SDK</span> for U-Boot and Linux, all <span class="caps">I2C</span> magically worked, and, e.g,
temp sensors could suddenly be used. This was important because some customers wanted to know
much more about the thermal side of our high end chips and jet engine fans didn&rsquo;t position us well
against Intel. Also, over 100 of the BOARD2s were to be modified also to be quiet by buying many few
fans and resistors to address a specific market. The new part number for such systems is <span class="caps">XXXX</span>.
The engineer that started the idea didn&rsquo;t really like the extra effort and cost that someone would have to
spend to make this happen, so he thought about the topic some more, to see if there was a simpler way
to make the system&nbsp;quiet.</p>
<p>Along comes a new special customer opportunity asking for a <span class="caps">BOARD1</span> in an application space where you can&rsquo;t
sell by going there with a noisy box. So a <span class="caps">BOARD1</span> was found to be modified, but the engineer was still thinking
about inexpensive options to make BOARD2s office use compatible.
Wasn&rsquo;t there a device in there called <span class="caps">W83793G</span> in both the <span class="caps">BOARD2</span> and <span class="caps">BOARD1</span> schematics called &ldquo;Winbond H/W
Monitor&rdquo;? Wasn&rsquo;t that device capable of doing <span class="caps">PWM</span> fan control? Wasn&rsquo;t it also capable of measuring
temp and doing autonomous fan control properly? Couldn&rsquo;t that chip be configured to do the right thing
about fans and&nbsp;noise?</p>
<p>So he looked at the different boards available to him and found the following&nbsp;situation:</p>
<ul>
<li><span class="caps">BOARD1</span><ul>
<li>The <span class="caps">W83793G</span> is sufficiently wired up in the <span class="caps">MODEL1</span> to be used for autonomous fan
control. It controls both fan <span class="caps">PWM</span> lines and can measure chip temp if properly
configured. Default pin config settings are not quite ok, but good&nbsp;enough.</li>
<li>The <span class="caps">MODEL1</span> BOARD2s don&rsquo;t have the <span class="caps">PWM</span> fans though. They only have fans with the tacho
signal, so there is nothing to&nbsp;control</li>
<li>The BOARD1s don&rsquo;t have the black shield that current BOARD2s have, so the back fans
can&rsquo;t be used to create suction through the main heat sink, eliminating all usefulness of
fan control. This can be remedied with a simple piece of U-shaped cardboard to fill the
gap between heat sink and back fans&hellip; which permits disconnecting the front fan&nbsp;completely.</li>
<li>The old <span class="caps">MODEL1</span> did have the four wire <span class="caps">PWM</span> fans, but such an old board can
only serve as spare parts box to&nbsp;strip.</li>
</ul>
</li>
<li><span class="caps">BOARD2</span><ul>
<li>The <span class="caps">BOARD2</span> comes with the back airflow shield that is needed for proper heat sink
temp control through the back fans. The front fan is totally pointless due to the  black
airflow shield, but we still connect it and pay for&nbsp;it</li>
<li>The fan <span class="caps">PWM</span> lines to the <span class="caps">W83793G</span> are wired up, so fan speed can be&nbsp;controlled</li>
<li>The <span class="caps">W83793G</span> is accessible with <span class="caps">I2C</span> <span class="caps">SW</span> patches applied to the <span class="caps">SDK</span>, despite not being
quite accessible as the schematics suggest. But <span class="caps">XX</span> schematics can be a bit strange
anyway at times as it seems&nbsp;&hellip;</li>
<li>It is shipped with four wire <span class="caps">PWM</span> fans that are not perfectly quiet, but quite bearable
when speed is&nbsp;reduced</li>
<li>&hellip; but the temp diodes are disconnected from the <span class="caps">W83793G</span> by choice of <span class="caps">BOM</span>, so
automatic control in <span class="caps">HW</span> is impossible. Linux could in theory do software based fan
control but our <span class="caps">SDK</span>&nbsp;doesn&rsquo;t.</li>
</ul>
</li>
</ul>
<p>So we have <span class="caps">BOARD1</span> which would be perfectly capable of being quiet by doing automatic fan control if it
had the <span class="caps">PWM</span> fans and the black airflow shield &hellip; but doesn&rsquo;t. <em>sigh</em></p>
<p>And we have BOARD2s which would be perfectly capable of being quiet by doing automatic fan control if
they had four resistors in a different place on the <span class="caps">PCB</span> &hellip; but don&rsquo;t. <em>sigh</em></p>
<p>The moral of the story is: We could have saved money on fans and leave a much better impression at
customers by doing it right with minimal extra review and&nbsp;changes.</p>
<p>Yes, the <span class="caps">W83793G</span> is a pretty obsolete part these days and other pure <span class="caps">HW</span> means may be better now,
but the fact that I found now that we had only 95% of the solution in place leads me to the final&nbsp;question.</p>
<p>Couldn&rsquo;t we have thought noise and airflow through before we issue a production manufacturing
order for such boards? We are actively paying for useless <span class="caps">BOM</span> that could have been <span class="caps">VERY</span>&nbsp;useful.</p>
<p>Coming back to the start: So what is the U-Boot environment line about? If you take <span class="caps">PWM</span> fans and put
them into a <span class="caps">BOARD1</span>, add the U-cardboard shape in the back to be like the <span class="caps">BOARD2</span> black airflow shield,
disconnect the front fan completely, and then run the line &hellip; you end up with a reasonable&nbsp;system.</p>
<p>And now I probably should figure out if there is a reasonable way to do <span class="caps">SW</span> based fan control on the <span class="caps">BOARD2</span>
under Linux. Too late for the many BOARD2s to be modified &hellip; Oh well more money down the drain&nbsp;&hellip;</p>
<p><span class="caps">BR</span></p>
</blockquote>
                </div>
                <footer class="text-right">
                    <p>- fuzzmz</p>
                </footer>
    <script data-isso="//discuss.fuzz.me.uk/"
            data-isso-avatar="false"
            src="//discuss.fuzz.me.uk/js/embed.min.js"></script>

    <section id="isso-thread"></section>
            </div>
        </div>
    </article>
</section>
<footer>
    <hr>
    <div class="row">
        <div class="col-xs-4 text-left">
            <p><small>
                ramblings on tech, life, and randomness by Serban Constantin
            </small></p>
        </div>
        <div class="col-xs-5 text-right">
            <p><small>
                Built by <a href="http://docs.getpelican.com/en/latest">Pelican</a> / <a href="https://github.com/ingwinlu/pelican-twitchy">pelican-twitchy</a>
                &middot;                    &copy; 2016 fuzzmz
            </small></p>
        </div>
    </div>
</footer>            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->
    <!-- jQuery Version 1.11.2 -->
    <script src="https://fuzz.me.uk/theme/js/jquery-1.11.2.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="https://fuzz.me.uk/theme/js/bootstrap.min.js"></script>
    <!-- twitchy Script -->
    <script src="https://fuzz.me.uk/theme/js/pelican_twitchy.min.js"></script>

</body>
</html>